<!DOCTYPE html><html lang="en" data-astro-cid-37fxchfa> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="icon" type="image/png" href="/images/favicon.png"><meta name="generator" content="Astro v4.16.18"><!-- Prevent FOUC by applying theme immediately --><script>
      (function () {
        // Apply theme class immediately to prevent flash
        const systemPrefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
        document.documentElement.classList.add(systemPrefersDark ? "dark-theme" : "light-theme");
      })();
    </script><!-- Apply base styles to prevent flash --><!-- Load main stylesheet --><link rel="stylesheet" href="/styles/highde.css"><!-- Set up theme change listener after main content loads --><script>
      window.addEventListener('DOMContentLoaded', function() {
        // Listen for system theme changes and update automatically
        window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change", (e) => {
          // Remove existing theme classes
          document.documentElement.classList.remove("light-theme", "dark-theme");
          
          // Apply new system theme
          document.documentElement.classList.add(e.matches ? "dark-theme" : "light-theme");
        });
      });
    </script><!-- Removed theme toggle functionality as it's no longer needed --><!-- SEO --><title>Day üíØ with Trail Magic | brunokoga.com</title><meta name="description" content="Unexpected kindness and help from trail angels on the Pacific Crest Trail"><link rel="canonical" href="https://brunokoga.com/adventures/pct/2024-07-26-day-with-trail-magic/"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://brunokoga.com/adventures/pct/2024-07-26-day-with-trail-magic/"><meta property="og:title" content="Day üíØ with Trail Magic | brunokoga.com"><meta property="og:description" content="Unexpected kindness and help from trail angels on the Pacific Crest Trail"><meta property="og:image" content="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0AF70121-CF5E-4C04-AC58-87FA72A18563_04E27330-84B4-4F6A-8E97-B7AFB342CBBB.jpg.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://brunokoga.com/adventures/pct/2024-07-26-day-with-trail-magic/"><meta property="twitter:title" content="Day üíØ with Trail Magic | brunokoga.com"><meta property="twitter:description" content="Unexpected kindness and help from trail angels on the Pacific Crest Trail"><meta property="twitter:image" content="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0AF70121-CF5E-4C04-AC58-87FA72A18563_04E27330-84B4-4F6A-8E97-B7AFB342CBBB.jpg.jpg"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="brunokoga.com" href="/rss.xml"><style>html{background-color:#fff}html.dark-theme{background-color:#1a1a1a}
.audio-box[data-astro-cid-pgr4kkuk]{background-color:var(--audio-bg);border:1px solid var(--border-color);border-radius:12px;padding:16px;margin-bottom:24px;transition:all .3s ease;box-shadow:0 2px 4px #0000001a}.audio-box[data-astro-cid-pgr4kkuk]:hover{border-color:var(--accent-color);box-shadow:0 4px 8px #8b5cf640}.speed-controls[data-astro-cid-pgr4kkuk]{margin-top:12px;text-align:center}audio[data-astro-cid-pgr4kkuk]{width:100%;height:44px;transition:all .3s ease;border-radius:8px;background-color:var(--highlight-bg)}.playback-speed-button[data-astro-cid-pgr4kkuk]{border:1px solid var(--border-color);background-color:var(--audio-button-bg);color:var(--audio-button-text);padding:8px 16px;margin:4px 8px;font-size:14px;font-weight:500;border-radius:8px;cursor:pointer;transition:all .3s ease;display:inline-block;text-decoration:none;box-shadow:0 1px 3px #0003}.playback-speed-button[data-astro-cid-pgr4kkuk]:hover{background-color:var(--audio-button-hover);color:#fff;border-color:var(--audio-button-hover);transform:translateY(-1px);box-shadow:0 2px 6px #8b5cf666}.playback-speed-button[data-astro-cid-pgr4kkuk]:active{transform:translateY(0);box-shadow:0 1px 3px #0003}.playback-speed-button[data-astro-cid-pgr4kkuk]:last-child{margin-right:0}.dark-theme .audio-box[data-astro-cid-pgr4kkuk]{background-color:#2d3748;border-color:#4a5568;box-shadow:0 2px 8px #0006}.dark-theme .audio-box[data-astro-cid-pgr4kkuk]:hover{background-color:#374151;box-shadow:0 4px 12px #8b5cf64d}.dark-theme audio[data-astro-cid-pgr4kkuk]{background-color:#1a202c;border:1px solid #4a5568;filter:brightness(.7) contrast(1.3) hue-rotate(180deg)}.dark-theme .playback-speed-button[data-astro-cid-pgr4kkuk]{background-color:#4a5568;color:#e2e8f0;border-color:#718096}.dark-theme .playback-speed-button[data-astro-cid-pgr4kkuk]:hover{background-color:#8b5cf6;color:#fff;box-shadow:0 2px 8px #8b5cf680}.light-theme .audio-box[data-astro-cid-pgr4kkuk]{background-color:#e0e0e0;border-color:#d0d0d0;box-shadow:0 2px 4px #0000001a}.light-theme audio[data-astro-cid-pgr4kkuk]{background-color:#f7fafc;border:1px solid #e2e8f0;filter:none}.light-theme .playback-speed-button[data-astro-cid-pgr4kkuk]{background-color:#f0f0f0;color:#333;border-color:#d0d0d0}.light-theme .playback-speed-button[data-astro-cid-pgr4kkuk]:hover{background-color:#639;color:#fff;box-shadow:0 2px 6px #6633994d}
.post-preview[data-astro-cid-jzq3evcu]{margin-bottom:2rem;padding-bottom:2rem;border-bottom:1px solid #eee}.post-preview[data-astro-cid-jzq3evcu]:last-child{border-bottom:none}.post-preview[data-astro-cid-jzq3evcu] h3[data-astro-cid-jzq3evcu]{margin:0 0 .5rem}.post-preview[data-astro-cid-jzq3evcu] h3[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]{text-decoration:none;color:inherit}.post-preview[data-astro-cid-jzq3evcu] h3[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]:hover{color:var(--accent-color, #8b5cf6)}.post-date[data-astro-cid-jzq3evcu]{color:#666;font-size:.9rem;margin-bottom:1rem;display:block}.post-description[data-astro-cid-jzq3evcu]{margin:1rem 0;color:#555;line-height:1.6}.post-cover-image[data-astro-cid-jzq3evcu]{margin:1.5rem 0;border-radius:8px;overflow:hidden}.post-cover-image[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]{display:block;text-decoration:none}.post-cover-image[data-astro-cid-jzq3evcu] img[data-astro-cid-jzq3evcu]{width:100%;height:200px;object-fit:cover;display:block;transition:transform .2s ease,opacity .2s ease}.post-cover-image[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]:hover img[data-astro-cid-jzq3evcu]{transform:scale(1.02);opacity:.9}.read-more[data-astro-cid-jzq3evcu]{margin-top:1rem}.read-more[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]{color:var(--accent-color, #8b5cf6);text-decoration:none;font-weight:500}.read-more[data-astro-cid-jzq3evcu] a[data-astro-cid-jzq3evcu]:hover{text-decoration:underline}.gpx-container[data-astro-cid-senuiu66]{margin:2rem 0;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px #0000001a;background:#fff}.gpx-header[data-astro-cid-senuiu66]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:1.5rem;text-align:center}.gpx-header[data-astro-cid-senuiu66] h3[data-astro-cid-senuiu66]{margin:0 0 .5rem;font-size:1.5rem;font-weight:600}.gpx-date[data-astro-cid-senuiu66]{margin:0 0 .5rem;opacity:.9;font-size:.9rem}.gpx-description[data-astro-cid-senuiu66]{margin:0;opacity:.8;font-size:.95rem;line-height:1.4}.gpx-map[data-astro-cid-senuiu66]{height:450px;width:100%}.elevation-section[data-astro-cid-senuiu66]{background:#f8f9fa;padding:1.5rem;border-top:1px solid #e9ecef}.elevation-section[data-astro-cid-senuiu66] h4[data-astro-cid-senuiu66]{margin:0 0 1rem;color:#495057;font-size:1.1rem}.elevation-chart[data-astro-cid-senuiu66]{height:150px;background:#fff;border-radius:6px;border:1px solid #e9ecef}.custom-emoji-icon{background:transparent!important;border:none!important;font-size:20px;text-align:center;line-height:1;filter:drop-shadow(0 2px 4px rgba(0,0,0,.3))}@media (max-width: 768px){.gpx-map[data-astro-cid-senuiu66]{height:300px}.gpx-header[data-astro-cid-senuiu66]{padding:1rem}.gpx-header[data-astro-cid-senuiu66] h3[data-astro-cid-senuiu66]{font-size:1.2rem}}
</style><style>.media-carousel-wrapper[data-astro-cid-cvpngeox]{margin:2rem 0;border-radius:12px;overflow:hidden;box-shadow:0 4px 12px #0000001a;border:1px solid var(--border-color)}.lazy-carousel[data-astro-cid-cvpngeox] .media-content[data-astro-cid-cvpngeox]{background:var(--highlight-bg);min-height:200px;display:flex;align-items:center;justify-content:center}.lazy-carousel[data-astro-cid-cvpngeox] .media-content[data-astro-cid-cvpngeox]:not([src]):not([data-loaded]){background:linear-gradient(90deg,var(--highlight-bg) 25%,var(--border-color) 50%,var(--highlight-bg) 75%);background-size:200% 100%;animation:loading 1.5s infinite}@keyframes loading{0%{background-position:200% 0}to{background-position:-200% 0}}.media-carousel[data-astro-cid-cvpngeox]{background:var(--audio-bg);padding:1rem}.swiper[data-astro-cid-cvpngeox]{width:100%;height:auto;min-height:300px;padding-bottom:50px}.swiper-slide[data-astro-cid-cvpngeox]{display:flex;justify-content:center;align-items:center}.media-item[data-astro-cid-cvpngeox]{width:100%;max-width:800px;display:flex;flex-direction:column;background:var(--bg-color);border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000000d;border:1px solid var(--border-color)}.photo-container[data-astro-cid-cvpngeox]{cursor:pointer;position:relative;width:100%}.photo-container[data-astro-cid-cvpngeox]:hover:after{content:"üîç";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2rem;background:#000000b3;color:#fff;padding:.5rem;border-radius:50%;opacity:0;animation:fadeIn .3s ease forwards}@keyframes fadeIn{to{opacity:1}}.media-content[data-astro-cid-cvpngeox]{width:100%;height:auto;max-height:600px;object-fit:contain;display:block;transition:transform .2s ease}.photo-container[data-astro-cid-cvpngeox]:hover .media-content[data-astro-cid-cvpngeox]{transform:scale(1.02)}.media-item[data-astro-cid-cvpngeox]:has(video){position:relative;cursor:pointer}.media-item[data-astro-cid-cvpngeox]:has(video):hover:after{content:"üîç";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:2rem;background:#000000b3;color:#fff;padding:.5rem;border-radius:50%;opacity:0;animation:fadeIn .3s ease forwards;z-index:2;pointer-events:none}.media-item[data-astro-cid-cvpngeox]:has(video):hover .media-content[data-astro-cid-cvpngeox]{transform:scale(1.02)}.media-caption[data-astro-cid-cvpngeox]{padding:.75rem 1rem;background:var(--bg-color);display:flex;align-items:center;gap:.5rem;border-top:1px solid var(--border-color)}.media-type[data-astro-cid-cvpngeox]{font-size:1rem}.media-title[data-astro-cid-cvpngeox]{font-size:.875rem;color:var(--text-muted);font-weight:500}.swiper-pagination[data-astro-cid-cvpngeox]{bottom:15px!important}.swiper-button-next[data-astro-cid-cvpngeox],.swiper-button-prev[data-astro-cid-cvpngeox]{color:#ffffffe6;background:#0006;border-radius:50%;width:36px;height:36px;margin-top:-18px;transition:background-color .3s ease}.swiper-button-next[data-astro-cid-cvpngeox]:hover,.swiper-button-prev[data-astro-cid-cvpngeox]:hover{background:#0009}.swiper-button-next[data-astro-cid-cvpngeox]:after,.swiper-button-prev[data-astro-cid-cvpngeox]:after{font-size:14px}.swiper-pagination-bullet[data-astro-cid-cvpngeox]{background:#fffc;opacity:1}.swiper-pagination-bullet-active[data-astro-cid-cvpngeox]{background:#fff}@media (max-width: 768px){.media-carousel-wrapper[data-astro-cid-cvpngeox]{margin:1.5rem -1rem;border-radius:0}.media-carousel[data-astro-cid-cvpngeox]{padding:.75rem}.swiper[data-astro-cid-cvpngeox]{min-height:250px;padding-bottom:40px}.media-content[data-astro-cid-cvpngeox]{max-height:400px}.swiper-button-next[data-astro-cid-cvpngeox],.swiper-button-prev[data-astro-cid-cvpngeox]{width:32px;height:32px;margin-top:-16px}.swiper-button-next[data-astro-cid-cvpngeox]:after,.swiper-button-prev[data-astro-cid-cvpngeox]:after{font-size:12px}}
</style></head> <body class="content container" data-astro-cid-37fxchfa> <!-- Sidebar Navigation --> <header class="masthead" data-astro-cid-37fxchfa> <!-- Profile Section - moved outside masthead-inner --> <div class="profile-section" data-astro-cid-37fxchfa> <div class="profile-image-container" data-astro-cid-37fxchfa> <img src="/images/profile.png" alt="Bruno Koga" class="profile-image" data-astro-cid-37fxchfa> </div> <h1 class="profile-name" data-astro-cid-37fxchfa>Bruno Koga</h1> <p class="profile-bio" data-astro-cid-37fxchfa>iOS Developer &amp; Tech Enthusiast. Sharing thoughts on technology, travel, and life experiences.</p> </div> <!-- Navigation - stays in masthead-inner at bottom --> <div class="masthead-inner" data-astro-cid-37fxchfa> <div class="colophon" data-astro-cid-37fxchfa> <ul class="colophon-links" data-astro-cid-37fxchfa> <li data-astro-cid-37fxchfa> <a href="/" class="" data-astro-cid-37fxchfa> About </a> </li> <li data-astro-cid-37fxchfa> <a href="/posts" class="" data-astro-cid-37fxchfa> Posts </a> </li><li data-astro-cid-37fxchfa> <a href="/projects" class="" data-astro-cid-37fxchfa> Projects </a> </li><li data-astro-cid-37fxchfa> <a href="/adventures" class="selected" data-astro-cid-37fxchfa> Adventures </a> </li><li data-astro-cid-37fxchfa> <a href="/cv" class="" data-astro-cid-37fxchfa> CV </a> </li><li data-astro-cid-37fxchfa> <a href="/contact" class="" data-astro-cid-37fxchfa> Contact </a> </li> </ul> </div> </div> </header> <!-- Main Content --> <main data-astro-cid-37fxchfa>  <div class="posts"> <!-- Main Content --> <div class="post"> <h1> <a href="/adventures/pct/2024-07-26-day-with-trail-magic"> Day üíØ with Trail Magic </a> </h1> <span class="post-date"> July 26, 2024 </span>  <div class="post-content"> <p>Day 100</p>
<p>Mile 1742.3 to mile 1777.3</p>
<p>PCT Miles: 35.0 (56.0km)</p>
<p>Total Miles: 1777.3 (2843.7km)</p>
<p>I started hiking a little bit later than I wanted today: the morning was chilly and my thermometer was showing 5 degrees celsius. I wasn‚Äôt expecting any of my nights here in Oregon to be that cold. Gladly my sleeping quilt (and not bag) did a good job üëç.</p>
<p>I‚Äôm trying to take advantage of the fact that Oregon is relatively flat to crush miles. Water is still more scarce than I imagined, but this actually helps since I stop less often to filter water (but I have longer and heavier water carries).</p>
<p>By 2pm I had already hiked 20 miles in a very uneventful morning. I was carrying 3 liters of water for the next 18 miles when I crossed paths with two southbounders smiling at me: ‚Äúyou have trail magic ahead!‚Äù. These are the words that every thru hiker loves to hear.</p>
<p>Ten minutes later there was it: trail angels had set a big tent with food and chairs. There were hammocks and games to play. They were making burgers üçî! I had two. And chips. And cookies. And cinnamon roll. And blueberry muffin ü´êüßÅ . And cantaloupesüçà . And watermelon üçâ. And cherries üçí. And strawberries üçì.</p>
<p>All of that in 40 minutes: I kept an eye on my watch. I didn‚Äôt want to be vortexed and miss my goal of 35 miles for today. I thanked the trail angels but it was time to go (with a very full belly).</p>
<p>An uneventful afternoon followed. The weather today was much better than the past days, so it was pleasant to hike, without sweating too much and having to drink (and carry) lots of water.</p>
<p>I arrived at camp at ten past eight. I made my cold soaked dinner, pitched my tent and observed the deers around the campsite. As I‚Äôm writing this (it‚Äôs 9:30pm) I can hear the deers walking around and getting closer to my tent. I know they like to lick the salt on hikers teaming poles handles. Well, I hope I can ignore them and sleep well üôÉ!</p>
<div class="media-carousel-wrapper " data-astro-cid-cvpngeox><div class="media-carousel" id="media-carousel-ewxvyn8ik" data-astro-cid-cvpngeox><div class="swiper" data-astro-cid-cvpngeox><div class="swiper-wrapper" data-astro-cid-cvpngeox><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0AF70121-CF5E-4C04-AC58-87FA72A18563_04E27330-84B4-4F6A-8E97-B7AFB342CBBB.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0AF70121-CF5E-4C04-AC58-87FA72A18563_04E27330-84B4-4F6A-8E97-B7AFB342CBBB.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0AF70121-CF5E-4C04-AC58-87FA72A18563_04E27330-84B4-4F6A-8E97-B7AFB342CBBB.jpg.jpg" alt="Photo 1" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 1</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0EAED6B6-5689-414F-A4CC-7D8D244A41A1_5594054A-2F19-42F4-B289-E5E8B07B29A3.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0EAED6B6-5689-414F-A4CC-7D8D244A41A1_5594054A-2F19-42F4-B289-E5E8B07B29A3.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/0EAED6B6-5689-414F-A4CC-7D8D244A41A1_5594054A-2F19-42F4-B289-E5E8B07B29A3.jpg.jpg" alt="Photo 2" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 2</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/31D3BC20-FE64-4595-A40B-2B76018C5D89_C7086BC1-894A-4933-A60B-319853C4B954.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/31D3BC20-FE64-4595-A40B-2B76018C5D89_C7086BC1-894A-4933-A60B-319853C4B954.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/31D3BC20-FE64-4595-A40B-2B76018C5D89_C7086BC1-894A-4933-A60B-319853C4B954.jpg.jpg" alt="Photo 3" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 3</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/99882186-54BB-4AAE-8772-1A1145A8ED09_EBF60EAB-5FA6-4303-AEF6-CC40E223E39A.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/99882186-54BB-4AAE-8772-1A1145A8ED09_EBF60EAB-5FA6-4303-AEF6-CC40E223E39A.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/99882186-54BB-4AAE-8772-1A1145A8ED09_EBF60EAB-5FA6-4303-AEF6-CC40E223E39A.jpg.jpg" alt="Photo 4" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 4</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/BAF112DE-C044-44BB-8BAA-F38A9B57E3DF_F45E29E9-AF84-4502-8CEB-70433F7EA162.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/BAF112DE-C044-44BB-8BAA-F38A9B57E3DF_F45E29E9-AF84-4502-8CEB-70433F7EA162.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/BAF112DE-C044-44BB-8BAA-F38A9B57E3DF_F45E29E9-AF84-4502-8CEB-70433F7EA162.jpg.jpg" alt="Photo 5" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 5</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/CF6C24AF-0936-484F-BF14-7FCA7B03BC6E_86F6CAED-A47C-4822-8DB3-A95279C46F38.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/CF6C24AF-0936-484F-BF14-7FCA7B03BC6E_86F6CAED-A47C-4822-8DB3-A95279C46F38.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/CF6C24AF-0936-484F-BF14-7FCA7B03BC6E_86F6CAED-A47C-4822-8DB3-A95279C46F38.jpg.jpg" alt="Photo 6" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 6</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/D82BAB28-555C-48E2-A2DB-5CEFB77028DB_C9E03C07-9945-4B4B-B021-07D586334F3D.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/D82BAB28-555C-48E2-A2DB-5CEFB77028DB_C9E03C07-9945-4B4B-B021-07D586334F3D.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/D82BAB28-555C-48E2-A2DB-5CEFB77028DB_C9E03C07-9945-4B4B-B021-07D586334F3D.jpg.jpg" alt="Photo 7" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 7</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><div class="photo-container" data-pswp-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/F2F7362F-7ED7-44C8-8E8B-6034D5C4F4E7_C4AC25B5-BCA8-44AC-8C16-5E4861D9AEDE.jpg.jpg" data-pswp-width="1920" data-pswp-height="1080" data-astro-cid-cvpngeox><img src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/F2F7362F-7ED7-44C8-8E8B-6034D5C4F4E7_C4AC25B5-BCA8-44AC-8C16-5E4861D9AEDE.jpg.jpg" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/photos/F2F7362F-7ED7-44C8-8E8B-6034D5C4F4E7_C4AC25B5-BCA8-44AC-8C16-5E4861D9AEDE.jpg.jpg" alt="Photo 8" loading="lazy" class="media-content" data-astro-cid-cvpngeox></div><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üì∑</span><span class="media-title" data-astro-cid-cvpngeox>Photo 8</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><video src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/4cce8107-97c8-4da6-9699-625e6231772d_video.mp4" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/4cce8107-97c8-4da6-9699-625e6231772d_video.mp4" controls preload="metadata" muted playsinline class="media-content" onloadedmetadata="this.currentTime = 0.1" data-astro-cid-cvpngeox><p data-astro-cid-cvpngeox>Your browser doesn't support HTML video.</p></video><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üé•</span><span class="media-title" data-astro-cid-cvpngeox>Video 1</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><video src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/53f8ca13-3c8f-4798-92ac-54bc7cb1ae02_video.mp4" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/53f8ca13-3c8f-4798-92ac-54bc7cb1ae02_video.mp4" controls preload="metadata" muted playsinline class="media-content" onloadedmetadata="this.currentTime = 0.1" data-astro-cid-cvpngeox><p data-astro-cid-cvpngeox>Your browser doesn't support HTML video.</p></video><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üé•</span><span class="media-title" data-astro-cid-cvpngeox>Video 2</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><video src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/6d913e8a-67a3-488b-bd3e-b894d8194e90_video.mp4" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/6d913e8a-67a3-488b-bd3e-b894d8194e90_video.mp4" controls preload="metadata" muted playsinline class="media-content" onloadedmetadata="this.currentTime = 0.1" data-astro-cid-cvpngeox><p data-astro-cid-cvpngeox>Your browser doesn't support HTML video.</p></video><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üé•</span><span class="media-title" data-astro-cid-cvpngeox>Video 3</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><video src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/b173b18e-3120-40c6-af4b-61f926ffa696_video.mp4" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/b173b18e-3120-40c6-af4b-61f926ffa696_video.mp4" controls preload="metadata" muted playsinline class="media-content" onloadedmetadata="this.currentTime = 0.1" data-astro-cid-cvpngeox><p data-astro-cid-cvpngeox>Your browser doesn't support HTML video.</p></video><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üé•</span><span class="media-title" data-astro-cid-cvpngeox>Video 4</span></div></div></div><div class="swiper-slide" data-astro-cid-cvpngeox><div class="media-item" data-astro-cid-cvpngeox><video src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/da76cf5d-18b7-4c61-89d8-e16f13cab5c0_video.mp4" data-src="https://bruno-polarsteps.s3.eu-central-1.amazonaws.com/pct/klamath-county/videos/da76cf5d-18b7-4c61-89d8-e16f13cab5c0_video.mp4" controls preload="metadata" muted playsinline class="media-content" onloadedmetadata="this.currentTime = 0.1" data-astro-cid-cvpngeox><p data-astro-cid-cvpngeox>Your browser doesn't support HTML video.</p></video><div class="media-caption" data-astro-cid-cvpngeox><span class="media-type" data-astro-cid-cvpngeox>üé•</span><span class="media-title" data-astro-cid-cvpngeox>Video 5</span></div></div></div></div><div class="swiper-pagination" data-astro-cid-cvpngeox></div><div class="swiper-button-next" data-astro-cid-cvpngeox></div><div class="swiper-button-prev" data-astro-cid-cvpngeox></div></div></div></div><script>(function(){const carouselId = "media-carousel-ewxvyn8ik";
const lazy = false;

(function() {
// Fullscreen gallery functionality
function initializeFullscreenGallery() {
  // Add click event listeners to both photo containers and videos
  const photoContainers = document.querySelectorAll(`#${carouselId} .photo-container`);
  const videos = document.querySelectorAll(`#${carouselId} .media-content[controls]`);
  
  // Get all media items in order
  const allMediaItems = document.querySelectorAll(`#${carouselId} .media-item`);
  
  allMediaItems.forEach((mediaItem, index) => {
    const photoContainer = mediaItem.querySelector('.photo-container');
    const video = mediaItem.querySelector('video');
    
    if (photoContainer) {
      photoContainer.addEventListener('click', () => {
        openFullscreenGallery(index);
      });
    } else if (video) {
      // Add click overlay for videos
      const clickOverlay = document.createElement('div');
      clickOverlay.style.cssText = `
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        cursor: pointer;
        z-index: 1;
        background: transparent;
      `;
      
      // Make media-item position relative if not already
      if (getComputedStyle(mediaItem).position === 'static') {
        mediaItem.style.position = 'relative';
      }
      
      mediaItem.appendChild(clickOverlay);
      clickOverlay.addEventListener('click', () => {
        openFullscreenGallery(index);
      });
    }
  });
}

function openFullscreenGallery(startIndex) {
  // Get all media items (photos and videos) in order
  const allMediaItems = document.querySelectorAll(`#${carouselId} .media-item`);
  const mediaItems = Array.from(allMediaItems).map(mediaItem => {
    const photoContainer = mediaItem.querySelector('.photo-container');
    const video = mediaItem.querySelector('video');
    
    if (photoContainer) {
      return {
        type: 'photo',
        src: photoContainer.getAttribute('data-pswp-src'),
        title: photoContainer.querySelector('img')?.alt || ''
      };
    } else if (video) {
      return {
        type: 'video',
        src: video.src || video.getAttribute('data-src'),
        title: mediaItem.querySelector('.media-title')?.textContent || ''
      };
    }
    return null;
  }).filter(Boolean);
  
  let currentIndex = startIndex;
  
  // Create fullscreen gallery overlay
  const overlay = document.createElement('div');
  overlay.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 10000;
    display: flex;
    align-items: center;
    justify-content: center;
    touch-action: none;
    user-select: none;
  `;
  
  // Media container
  const mediaContainer = document.createElement('div');
  mediaContainer.style.cssText = `
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
  `;
  
  // Main media element (will be img or video)
  let currentMedia = null;
  
  // Close button
  const closeBtn = document.createElement('button');
  closeBtn.innerHTML = '√ó';
  closeBtn.style.cssText = `
    position: absolute;
    top: 20px;
    right: 30px;
    background: rgba(0, 0, 0, 0.5);
    border: none;
    color: white;
    font-size: 40px;
    cursor: pointer;
    z-index: 10001;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
  `;
  
  // Counter
  const counter = document.createElement('div');
  counter.style.cssText = `
    position: absolute;
    top: 20px;
    left: 30px;
    color: white;
    font-size: 16px;
    background: rgba(0, 0, 0, 0.5);
    padding: 10px 15px;
    border-radius: 20px;
    z-index: 10001;
  `;
  
  // Navigation arrows (only show if more than 1 media item)
  let prevBtn, nextBtn;
  if (mediaItems.length > 1) {
    prevBtn = document.createElement('button');
    prevBtn.innerHTML = '‚Äπ';
    prevBtn.style.cssText = `
      position: absolute;
      left: 30px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      font-size: 30px;
      cursor: pointer;
      z-index: 10001;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    `;
    
    nextBtn = document.createElement('button');
    nextBtn.innerHTML = '‚Ä∫';
    nextBtn.style.cssText = `
      position: absolute;
      right: 30px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0, 0, 0, 0.5);
      border: none;
      color: white;
      font-size: 30px;
      cursor: pointer;
      z-index: 10001;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      display: flex;
      align-items: center;
      justify-content: center;
    `;
  }
  
  // Create media element (image or video)
  function createMediaElement(mediaItem) {
    if (mediaItem.type === 'photo') {
      const img = document.createElement('img');
      img.src = mediaItem.src;
      img.alt = mediaItem.title;
      img.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        transition: transform 0.3s ease;
        pointer-events: none;
      `;
      return img;
    } else if (mediaItem.type === 'video') {
      const video = document.createElement('video');
      video.src = mediaItem.src;
      video.controls = true;
      video.preload = 'metadata';
      video.muted = true;
      video.playsInline = true;
      video.style.cssText = `
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        transition: transform 0.3s ease;
      `;
      
      // Show first frame when metadata loads
      video.addEventListener('loadedmetadata', function() {
        this.currentTime = 0.1;
      });
      
      return video;
    }
    return null;
  }

  // Update media function
  function updateMedia() {
    const currentItem = mediaItems[currentIndex];
    
    // Remove existing media
    if (currentMedia) {
      // Pause video if it's playing
      if (currentMedia.tagName === 'VIDEO' && !currentMedia.paused) {
        currentMedia.pause();
      }
      mediaContainer.removeChild(currentMedia);
    }
    
    // Create and add new media
    currentMedia = createMediaElement(currentItem);
    if (currentMedia) {
      mediaContainer.appendChild(currentMedia);
    }
    
    counter.textContent = `${currentIndex + 1} / ${mediaItems.length}`;
    
    // Update navigation button states
    if (prevBtn) prevBtn.style.opacity = currentIndex > 0 ? '1' : '0.3';
    if (nextBtn) nextBtn.style.opacity = currentIndex < mediaItems.length - 1 ? '1' : '0.3';
  }
  
  // Navigation functions
  function goToPrev() {
    if (currentIndex > 0) {
      currentIndex--;
      updateMedia();
    }
  }
  
  function goToNext() {
    if (currentIndex < mediaItems.length - 1) {
      currentIndex++;
      updateMedia();
    }
  }
  
  // Assemble the gallery
  overlay.appendChild(mediaContainer);
  overlay.appendChild(closeBtn);
  overlay.appendChild(counter);
  
  if (mediaItems.length > 1) {
    overlay.appendChild(prevBtn);
    overlay.appendChild(nextBtn);
    
    // Button event listeners
    prevBtn.addEventListener('click', goToPrev);
    nextBtn.addEventListener('click', goToNext);
  }
  
  document.body.appendChild(overlay);
  
  // Initialize with current media
  updateMedia();
  
  // Touch/swipe handling for mobile
  let startX = 0;
  let startY = 0;
  let isDragging = false;
  
  mediaContainer.addEventListener('touchstart', (e) => {
    if (mediaItems.length <= 1) return;
    startX = e.touches[0].clientX;
    startY = e.touches[0].clientY;
    isDragging = true;
  }, { passive: true });
  
  mediaContainer.addEventListener('touchmove', (e) => {
    if (!isDragging || mediaItems.length <= 1) return;
    e.preventDefault();
    
    const currentX = e.touches[0].clientX;
    const diffX = startX - currentX;
    
    // Visual feedback during swipe
    if (Math.abs(diffX) > 10 && currentMedia) {
      const opacity = Math.max(0.3, 1 - Math.abs(diffX) / 300);
      currentMedia.style.transform = `translateX(${-diffX}px)`;
      currentMedia.style.opacity = opacity;
    }
  }, { passive: false });
  
  mediaContainer.addEventListener('touchend', (e) => {
    if (!isDragging || mediaItems.length <= 1) return;
    
    const endX = e.changedTouches[0].clientX;
    const diffX = startX - endX;
    const diffY = Math.abs(startY - e.changedTouches[0].clientY);
    
    // Reset media transform
    if (currentMedia) {
      currentMedia.style.transform = '';
      currentMedia.style.opacity = '';
    }
    
    // Only trigger swipe if horizontal movement is greater than vertical
    if (Math.abs(diffX) > diffY && Math.abs(diffX) > 50) {
      if (diffX > 0) {
        goToNext(); // Swipe left = next media
      } else {
        goToPrev(); // Swipe right = previous media
      }
    }
    
    isDragging = false;
  }, { passive: true });
  
  // Mouse drag handling for desktop
  let mouseDown = false;
  let mouseStartX = 0;
  
  mediaContainer.addEventListener('mousedown', (e) => {
    if (mediaItems.length <= 1) return;
    mouseDown = true;
    mouseStartX = e.clientX;
    mediaContainer.style.cursor = 'grabbing';
  });
  
  mediaContainer.addEventListener('mousemove', (e) => {
    if (!mouseDown || mediaItems.length <= 1) return;
    
    const diffX = mouseStartX - e.clientX;
    if (Math.abs(diffX) > 10 && currentMedia) {
      const opacity = Math.max(0.3, 1 - Math.abs(diffX) / 300);
      currentMedia.style.transform = `translateX(${-diffX}px)`;
      currentMedia.style.opacity = opacity;
    }
  });
  
  mediaContainer.addEventListener('mouseup', (e) => {
    if (!mouseDown || mediaItems.length <= 1) return;
    
    const diffX = mouseStartX - e.clientX;
    
    // Reset media transform
    if (currentMedia) {
      currentMedia.style.transform = '';
      currentMedia.style.opacity = '';
    }
    mediaContainer.style.cursor = '';
    
    if (Math.abs(diffX) > 50) {
      if (diffX > 0) {
        goToNext();
      } else {
        goToPrev();
      }
    }
    
    mouseDown = false;
  });
  
  // Keyboard navigation
  const handleKeyDown = (e) => {
    switch(e.key) {
      case 'Escape':
        closeModal();
        break;
      case 'ArrowLeft':
        goToPrev();
        break;
      case 'ArrowRight':
        goToNext();
        break;
    }
  };
  
  // Close modal function
  const closeModal = () => {
    document.body.removeChild(overlay);
    document.removeEventListener('keydown', handleKeyDown);
  };
  
  // Event listeners
  closeBtn.addEventListener('click', closeModal);
  document.addEventListener('keydown', handleKeyDown);
  
  // Prevent scrolling on mobile when gallery is open
  document.body.style.overflow = 'hidden';
  
  // Restore scrolling when closed
  const originalCloseModal = closeModal;
  closeModal = () => {
    document.body.style.overflow = '';
    originalCloseModal();
  };
}
// Lazy loading function
function loadCarouselMedia() {
  const carousel = document.querySelector(`#${carouselId}`);
  if (!carousel) return;

  const images = carousel.querySelectorAll('img[data-src]');
  const videos = carousel.querySelectorAll('video[data-src]');

  images.forEach(img => {
    if (img.dataset.src && (!img.src || img.src === '' || img.src === window.location.href)) {
      img.src = img.dataset.src;
      img.setAttribute('data-loaded', 'true');
    }
  });

  videos.forEach(video => {
    if (video.dataset.src && (!video.src || video.src === '' || video.src === window.location.href)) {
      video.src = video.dataset.src;
      video.setAttribute('data-loaded', 'true');
    }
  });
}

function initializeCarousel() {
  const swiperElement = document.querySelector(`#${carouselId} .swiper`);
  if (!swiperElement) {
    return;
  }
  
  // Load media if lazy loading is enabled
  if (lazy) {
    loadCarouselMedia();
  }
  
  // Initialize fullscreen gallery
  initializeFullscreenGallery();
  
  new Swiper(swiperElement, {
    slidesPerView: 1,
    spaceBetween: 20,
    loop: false,
    navigation: {
      nextEl: `#${carouselId} .swiper-button-next`,
      prevEl: `#${carouselId} .swiper-button-prev`,
    },
    pagination: {
      el: `#${carouselId} .swiper-pagination`,
      clickable: true,
      dynamicBullets: true,
    },
    keyboard: {
      enabled: true,
      onlyInViewport: true,
    },
    on: {
      slideChange: function() {
        // Pause all videos when sliding
        const videos = this.el.querySelectorAll('video');
        videos.forEach(video => {
          if (!video.paused) {
            video.pause();
          }
        });
      }
    }
  });
}

// Initialize Swiper when loaded
function initializeSwiper() {
  // Ensure Swiper CSS is loaded first
  if (!document.querySelector('link[href*="swiper"]')) {
    const swiperCSS = document.createElement('link');
    swiperCSS.rel = 'stylesheet';
    swiperCSS.href = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css';
    document.head.appendChild(swiperCSS);
  }

  // Load Swiper JS if not available
  if (typeof Swiper === 'undefined') {
    if (!document.querySelector('script[src*="swiper"]')) {
      const swiperScript = document.createElement('script');
      swiperScript.src = 'https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js';
      swiperScript.onload = function() {
        initializeCarousel();
      };
      document.head.appendChild(swiperScript);
      return;
    } else {
      // Script is loading, wait for it
      setTimeout(initializeSwiper, 100);
      return;
    }
  }

  initializeCarousel();
}

// Setup intersection observer for lazy loading
if (lazy) {
  function setupIntersectionObserver() {
    const carouselElement = document.querySelector(`#${carouselId}`);
    
    if (!carouselElement) {
      setTimeout(setupIntersectionObserver, 100);
      return;
    }

    const observerOptions = {
      root: null,
      rootMargin: '100px',
      threshold: 0.1
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          observer.unobserve(entry.target);
          initializeSwiper();
        }
      });
    }, observerOptions);

    observer.observe(carouselElement);
  }

  // Setup observer when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', setupIntersectionObserver);
  } else {
    setupIntersectionObserver();
  }
} else {
  // Initialize immediately for non-lazy carousels
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', () => {
      setTimeout(initializeSwiper, 50);
    });
  } else {
    setTimeout(initializeSwiper, 50);
  }
}
})();
})();</script> </div> <!-- GPX Map for adventure posts --> <div class="gpx-container" data-astro-cid-senuiu66> <div class="gpx-header" data-astro-cid-senuiu66> <h3 data-astro-cid-senuiu66>Route: Day üíØ with Trail Magic</h3> <p class="gpx-date" data-astro-cid-senuiu66>July 26, 2024</p>  </div> <div id="gpx-map-mqfqg2c5r" class="gpx-map" data-astro-cid-senuiu66></div>  </div> <script>(function(){const mapId = "gpx-map-mqfqg2c5r";
const elevationId = "elevation-pd4mojp0m";
const gpxFile = "/gpx/pct/2024-07-26-day-with-trail-magic.gpx";
const showElevation = false;
const mapStyle = "outdoor";

  // Load required libraries
  Promise.all([
    import('https://unpkg.com/leaflet@1.9.4/dist/leaflet.js')
  ]).then(() => {
    // Initialize map
    const map = L.map(mapId).setView([0, 0], 2);
    
    // Choose tile layer based on style
    let tileLayer;
    switch(mapStyle) {
      case 'satellite':
        tileLayer = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
          attribution: 'Tiles &copy; Esri &mdash; Source: Esri, Maxar, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community'
        });
        break;
      case 'outdoor':
        // Use OpenTopoMap for hiking/outdoor activities - shows topography, trails, etc.
        tileLayer = L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', {
          attribution: 'Map data: ¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: ¬© <a href="https://opentopomap.org">OpenTopoMap</a>',
          maxZoom: 17
        });
        break;
      default: // streets
        tileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
          attribution: '¬© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        });
    }
    
    tileLayer.addTo(map);
    
    // Custom icons
    const startIcon = L.divIcon({
      html: 'üü¢',
      className: 'custom-emoji-icon',
      iconSize: [25, 25],
      iconAnchor: [12, 12]
    });
    
    const endIcon = L.divIcon({
      html: 'üî¥',
      className: 'custom-emoji-icon',
      iconSize: [25, 25],
      iconAnchor: [12, 12]
    });
    
    // Load and display GPX
    fetch(gpxFile)
      .then(response => {
        if (!response.ok) {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }
        return response.text();
      })
      .then(gpxData => {
        // Parse XML
        const parser = new DOMParser();
        const xmlDoc = parser.parseFromString(gpxData, 'text/xml');
        
        // Check for parsing errors
        const parseError = xmlDoc.querySelector('parsererror');
        if (parseError) {
          throw new Error('XML parsing error: ' + parseError.textContent);
        }
        
        // Extract track points
        const trackPoints = xmlDoc.querySelectorAll('trkpt');
        
        if (trackPoints.length === 0) {
          throw new Error('No track points found in GPX file');
        }
        
        // Extract coordinates
        const coordinates = [];
        
        trackPoints.forEach((point) => {
          const lat = parseFloat(point.getAttribute('lat'));
          const lon = parseFloat(point.getAttribute('lon'));
          coordinates.push([lat, lon]);
        });
        
        // Create polyline
        const polyline = L.polyline(coordinates, {
          color: '#3388ff',
          weight: 4,
          opacity: 0.8,
          smoothFactor: 2
        }).addTo(map);
        
        // Add start and end markers
        L.marker(coordinates[0], { icon: startIcon }).addTo(map);
        L.marker(coordinates[coordinates.length - 1], { icon: endIcon }).addTo(map);
        
        // Fit map to track bounds
        map.fitBounds(polyline.getBounds(), { padding: [20, 20] });
        
      })
      .catch(error => {
        console.error('Error loading GPX file:', error);
      });
  });
})();</script>  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"> </div> <!-- Subposts from item subfolder -->  </div>  </main> <!-- Footer --> <footer data-astro-cid-37fxchfa> <!-- Empty footer as per original theme --> </footer> </body></html>